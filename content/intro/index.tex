\chapter{Introduction}
In software development, automated tests are one of the key tools
to achieve a high level of software quality.
Writing tests efficiently itself requires good support
from the programming language, standard library, or third party tools.
We will take a look at two types of testing tools:
\begin{itemize}
  \item \textit{assertion libraries} and
  \item \textit{stubbing / mocking libraries}.
\end{itemize}
Both can be standalone or part of a greater testing framework or utility library.
The former are used to specify a part of the \textit{test oracle},
deciding whether a test case is considered to pass successfully or fail with an error.
The latter are particularly important for substituting subsystems in component testing,
and mock expectations can also form another part of the test oracle.

Assertions are often encoded as chained function calls,
sometimes called \textit{BDD (behavior-driven development)} style,
or in a more classical style as plain calls to an assertion function:
\autocite{ChaiBddDoc}\autocite{ChaiTddDoc}
\begin{minted}{javascript}
expect(1).to.equal(1);
assert(1 === 1);
\end{minted}
Stubbing and mocking libraries tend to follow a similar API design approach:
\autocite{SinonStubDoc}\autocite{SinonMockDoc}
\begin{minted}{javascript}
const doubleStub = stub().withArgs(21).returns(42);
const myMock = mock(myApi).expects("method")
                          .once().withArgs(42, 1337);
\end{minted}

\paragraph{The Spock Framework DSL}
The popular testing framework \textit{Spock Framework}
for the Groovy programming language takes a different route.
It defines a \textit{domain-specific language (DSL)} for the test cases
that allows expressing assertions and stub / mock interactions in a very concise way.
This DSL cannot be implemented entirely by a `userspace' library, therefore,
Spock hooks into the compiler and transforms the syntax tree prior to test execution.
